# PanSou ç½‘ç›˜æœç´¢API

PanSouæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ç½‘ç›˜èµ„æºæœç´¢APIæœåŠ¡ï¼Œæ”¯æŒTGæœç´¢å’Œè‡ªå®šä¹‰æ’ä»¶æœç´¢ã€‚ç³»ç»Ÿè®¾è®¡ä»¥æ€§èƒ½å’Œå¯æ‰©å±•æ€§ä¸ºæ ¸å¿ƒï¼Œæ”¯æŒå¹¶å‘æœç´¢ã€ç»“æœæ™ºèƒ½æ’åºå’Œç½‘ç›˜ç±»å‹åˆ†ç±»ã€‚

## ğŸš€ æ€§èƒ½è¡¨ç°

å®æµ‹ PanSou åœ¨ 8GB MacBook Pro ä¸Šçš„æ€§èƒ½è¡¨ç°ï¼š

- âœ… **500ç”¨æˆ·ç¬æ—¶å¹¶å‘**: 100%æˆåŠŸç‡ï¼Œå¹³å‡å“åº”167ms
- âœ… **200ç”¨æˆ·æŒç»­å¹¶å‘**: 30ç§’å†…å¤„ç†4725è¯·æ±‚ï¼ŒQPS=148
- âœ… **ç¼“å­˜å‘½ä¸­**: 99.8%è¯·æ±‚<100mså“åº”æ—¶é—´  
- âœ… **é«˜å¯ç”¨æ€§**: é•¿æ—¶é—´è¿è¡Œæ— æ•…éšœ


## ç‰¹æ€§ï¼ˆ[è¯¦æƒ…è§ç³»ç»Ÿå¼€å‘è®¾è®¡æ–‡æ¡£](docs/%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3.md)ï¼‰

- **é«˜æ€§èƒ½æœç´¢**ï¼šå¹¶å‘æœç´¢å¤šä¸ªTelegramé¢‘é“ï¼Œæ˜¾è‘—æå‡æœç´¢é€Ÿåº¦ï¼›å·¥ä½œæ± è®¾è®¡ï¼Œé«˜æ•ˆç®¡ç†å¹¶å‘ä»»åŠ¡
- **ç½‘ç›˜ç±»å‹åˆ†ç±»**ï¼šè‡ªåŠ¨è¯†åˆ«å¤šç§ç½‘ç›˜é“¾æ¥ï¼ŒæŒ‰ç±»å‹å½’ç±»å±•ç¤º
- **æ™ºèƒ½æ’åº**ï¼šåŸºäºæ’ä»¶ç­‰çº§ã€æ—¶é—´æ–°é²œåº¦å’Œä¼˜å…ˆå…³é”®è¯çš„å¤šç»´åº¦ç»¼åˆæ’åºç®—æ³•
  - **æ’ä»¶ç­‰çº§æƒé‡**ï¼šç­‰çº§1æ’ä»¶(1000åˆ†) > ç­‰çº§2æ’ä»¶(500åˆ†) > ç­‰çº§3æ’ä»¶(0åˆ†)
  - **ä¼˜å…ˆå…³é”®è¯åŠ åˆ†**ï¼šåŒ…å«"åˆé›†"(420åˆ†)ã€"ç³»åˆ—"(350åˆ†)ç­‰ä¼˜å…ˆå…³é”®è¯çš„èµ„æºæ˜¾è‘—æå‡æ’åº
  - **æ—¶é—´æ–°é²œåº¦æƒé‡**ï¼š1å¤©å†…(500åˆ†) > 3å¤©å†…(400åˆ†) > 1å‘¨å†…(300åˆ†) > 1æœˆå†…(200åˆ†)
  - **ç»¼åˆå¾—åˆ†æ’åº**ï¼šæ€»å¾—åˆ† = æ’ä»¶å¾—åˆ† + å…³é”®è¯å¾—åˆ† + æ—¶é—´å¾—åˆ†
- **å¼‚æ­¥æ’ä»¶ç³»ç»Ÿ**ï¼šæ”¯æŒé€šè¿‡æ’ä»¶æ‰©å±•æœç´¢æ¥æºï¼Œå·²å†…ç½®å¤šä¸ªç½‘ç›˜æœç´¢æ’ä»¶ï¼Œè¯¦æƒ…å‚è€ƒ[æ’ä»¶å¼€å‘æŒ‡å—.md](docs/æ’ä»¶å¼€å‘æŒ‡å—.md)ï¼›æ”¯æŒ"å°½å¿«å“åº”ï¼ŒæŒç»­å¤„ç†"çš„å¼‚æ­¥æœç´¢æ¨¡å¼ï¼Œè§£å†³äº†æŸäº›æœç´¢æºå“åº”æ—¶é—´é•¿çš„é—®é¢˜
  - **åŒçº§è¶…æ—¶æ§åˆ¶**ï¼šçŸ­è¶…æ—¶(4ç§’)ç¡®ä¿å¿«é€Ÿå“åº”ï¼Œé•¿è¶…æ—¶(30ç§’)å…è®¸å®Œæ•´å¤„ç†
  - **æŒä¹…åŒ–ç¼“å­˜**ï¼šç¼“å­˜è‡ªåŠ¨ä¿å­˜åˆ°ç£ç›˜ï¼Œç³»ç»Ÿé‡å¯åè‡ªåŠ¨æ¢å¤
  - **ä¼˜é›…å…³é—­**ï¼šåœ¨ç¨‹åºé€€å‡ºå‰ä¿å­˜ç¼“å­˜ï¼Œç¡®ä¿æ•°æ®ä¸ä¸¢å¤±
  - **å¢é‡æ›´æ–°**ï¼šæ™ºèƒ½åˆå¹¶æ–°æ—§ç»“æœï¼Œä¿ç•™æœ‰ä»·å€¼çš„æ•°æ®
  - **ä¸»åŠ¨æ›´æ–°**ï¼šå¼‚æ­¥æ’ä»¶åœ¨ç¼“å­˜å¼‚æ­¥æ›´æ–°åä¼šä¸»åŠ¨æ›´æ–°ä¸»ç¼“å­˜(å†…å­˜+ç£ç›˜)ï¼Œä½¿ç”¨æˆ·åœ¨ä¸å¼ºåˆ¶åˆ·æ–°çš„æƒ…å†µä¸‹ä¹Ÿèƒ½è·å–æœ€æ–°æ•°æ®
  - **ç¼“å­˜ä¼˜åŒ–**ï¼šæ™ºèƒ½è·³è¿‡ç©ºç»“æœå’Œé‡å¤æ•°æ®çš„ç¼“å­˜æ›´æ–°ï¼Œæ˜¾è‘—å‡å°‘æ— æ•ˆæ“ä½œï¼Œæå‡ç³»ç»Ÿæ€§èƒ½
  - **æ’ä»¶ç®¡ç†**ï¼šå¯åŠ¨æ—¶æŒ‰ä¼˜å…ˆçº§æ’åºæ˜¾ç¤ºå·²åŠ è½½æ’ä»¶ï¼Œä¾¿äºç›‘æ§å’Œè°ƒè¯•
- **æ’ä»¶æ‰©å±•å‚æ•°**ï¼šé€šè¿‡extå‚æ•°å‘æ’ä»¶ä¼ é€’è‡ªå®šä¹‰æœç´¢å‚æ•°ï¼Œå¦‚è‹±æ–‡æ ‡é¢˜ã€å…¨é‡æœç´¢æ ‡å¿—ç­‰ï¼Œæé«˜æœç´¢çµæ´»æ€§å’Œç²¾ç¡®åº¦
- **äºŒçº§ç¼“å­˜**ï¼šåˆ†ç‰‡å†…å­˜+åˆ†ç‰‡ç£ç›˜ç¼“å­˜æœºåˆ¶ï¼Œå¤§å¹…æå‡é‡å¤æŸ¥è¯¢é€Ÿåº¦å’Œå¹¶å‘æ€§èƒ½  
  - **åˆ†ç‰‡å†…å­˜ç¼“å­˜**ï¼šåŸºäºCPUæ ¸å¿ƒæ•°åŠ¨æ€åˆ†ç‰‡çš„å†…å­˜ç¼“å­˜ï¼Œæ¯ä¸ªåˆ†ç‰‡ç‹¬ç«‹é”æœºåˆ¶ï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®ï¼›ä½¿ç”¨åŸå­æ“ä½œä¼˜åŒ–çƒ­ç‚¹æ•°æ®æ›´æ–°ï¼Œæ˜¾è‘—å‡å°‘é”ç«äº‰
  - **åˆ†ç‰‡ç£ç›˜ç¼“å­˜**ï¼šé‡‡ç”¨åŠ¨æ€åˆ†ç‰‡æ•°é‡ï¼ˆåŸºäºCPUæ ¸å¿ƒæ•°ï¼‰ï¼Œé€šè¿‡ä½è¿ç®—å“ˆå¸Œç®—æ³•å°†ç¼“å­˜é”®å‡åŒ€åˆ†å¸ƒï¼Œæé«˜é«˜å¹¶å‘åœºæ™¯ä¸‹çš„I/Oæ€§èƒ½
  - **åºåˆ—åŒ–å™¨æ¥å£**ï¼šGobåºåˆ—åŒ–æä¾›æ›´é«˜æ€§èƒ½å’Œæ›´å°çš„ç»“æœå¤§å°
  - **åˆ†ç¦»çš„ç¼“å­˜é”®**ï¼šTGæœç´¢å’Œæ’ä»¶æœç´¢ä½¿ç”¨ç‹¬ç«‹çš„ç¼“å­˜é”®ï¼Œå®ç°ç‹¬ç«‹æ›´æ–°ï¼Œäº’ä¸å½±å“ï¼Œæé«˜ç¼“å­˜å‘½ä¸­ç‡å’Œæ›´æ–°æ•ˆç‡
  - **ä¼˜åŒ–çš„ç¼“å­˜è¯»å–ç­–ç•¥**ï¼šä¼˜å…ˆä½¿ç”¨å†…å­˜ç¼“å­˜ï¼Œå…¶æ¬¡ä»ç£ç›˜è¯»å–ç¼“å­˜æ•°æ®
- **ä¼˜åŒ–çš„HTTPæœåŠ¡å™¨é…ç½®**ï¼š
  - **è‡ªåŠ¨è®¡ç®—çš„è¶…æ—¶è®¾ç½®**ï¼šæ ¹æ®ç³»ç»Ÿé…ç½®å’Œå¼‚æ­¥æ’ä»¶éœ€æ±‚è‡ªåŠ¨è°ƒæ•´è¯»å–è¶…æ—¶ã€å†™å…¥è¶…æ—¶å’Œç©ºé—²è¶…æ—¶
  - **è¿æ¥æ•°é™åˆ¶**ï¼šæ ¹æ®CPUæ ¸å¿ƒæ•°è‡ªåŠ¨è®¡ç®—æœ€å¤§å¹¶å‘è¿æ¥æ•°ï¼Œé˜²æ­¢èµ„æºè€—å°½
  - **é«˜æ€§èƒ½è¿æ¥ç®¡ç†**ï¼šä¼˜åŒ–çš„è¿æ¥å¤ç”¨å’Œé‡Šæ”¾ç­–ç•¥ï¼Œæé«˜é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ€§èƒ½

## æ”¯æŒçš„ç½‘ç›˜ç±»å‹

- ç™¾åº¦ç½‘ç›˜ (`baidu`)
- é˜¿é‡Œäº‘ç›˜ (`aliyun`)
- å¤¸å…‹ç½‘ç›˜ (`quark`)
- å¤©ç¿¼äº‘ç›˜ (`tianyi`)
- UCç½‘ç›˜ (`uc`)
- ç§»åŠ¨äº‘ç›˜ (`mobile`)
- 115ç½‘ç›˜ (`115`)
- PikPak (`pikpak`)
- è¿…é›·ç½‘ç›˜ (`xunlei`)
- 123ç½‘ç›˜ (`123`)
- ç£åŠ›é“¾æ¥ (`magnet`)
- ç”µé©´é“¾æ¥ (`ed2k`)
- å…¶ä»– (`others`)

## å¿«é€Ÿå¼€å§‹

åœ¨ Github ä¸Šå…ˆ [Fork](https://github.com/fish2018/pansou/fork) æœ¬é¡¹ç›®ï¼Œå¹¶ç‚¹ä¸Š Star !!!

### ç¯å¢ƒè¦æ±‚

- Go 1.18+
- å¯é€‰ï¼šSOCKS5ä»£ç†ï¼ˆç”¨äºè®¿é—®å—é™åœ°åŒºçš„Telegramç«™ç‚¹ï¼‰

### ä½¿ç”¨Dockeréƒ¨ç½²

#### æ–¹æ³•1ï¼šä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰

1. ä¸‹è½½docker-compose.ymlæ–‡ä»¶

```bash
wget https://raw.githubusercontent.com/fish2018/pansou/main/docker-compose.yml
```

2. å¯åŠ¨æœåŠ¡

```bash
docker-compose up -d
```

3. è®¿é—®æœåŠ¡

```
http://localhost:8888
```

#### æ–¹æ³•2ï¼šç›´æ¥ä½¿ç”¨Dockerå‘½ä»¤

```bash
docker run -d --name pansou \
  -p 8888:8888 \
  -v pansou-cache:/app/cache \
  -e CHANNELS="tgsearchers2,SharePanBaidu,yunpanxunlei" \
  -e CACHE_ENABLED=true \
  -e ASYNC_PLUGIN_ENABLED=true \
  ghcr.io/fish2018/pansou:latest
```

### ä»æºç å®‰è£…

1. å…‹éš†ä»“åº“

```bash
git clone https://github.com/fish2018/pansou.git
cd pansou
```

2. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

| ç¯å¢ƒå˜é‡ | æè¿° | é»˜è®¤å€¼ |
|----------|------|--------|
| CHANNELS | é»˜è®¤æœç´¢é¢‘é“åˆ—è¡¨ï¼ˆé€—å·åˆ†éš”ï¼‰ | tgsearchers2 |
| CONCURRENCY | é»˜è®¤å¹¶å‘æ•° | é¢‘é“æ•°+æ’ä»¶æ•°+10 |
| PORT | æœåŠ¡ç«¯å£ | 8888 |
| PROXY | SOCKS5ä»£ç† | - |
| CACHE_ENABLED | æ˜¯å¦å¯ç”¨ç¼“å­˜ | true |
| CACHE_PATH | ç¼“å­˜æ–‡ä»¶è·¯å¾„ | ./cache |
| CACHE_MAX_SIZE | æœ€å¤§ç¼“å­˜å¤§å°(MB) | 100 |
| CACHE_TTL | ç¼“å­˜ç”Ÿå­˜æ—¶é—´(åˆ†é’Ÿ) | 60 |
| SHARD_COUNT | ç¼“å­˜åˆ†ç‰‡æ•°é‡ | 8 |
| SERIALIZER_TYPE | åºåˆ—åŒ–å™¨ç±»å‹(gob/json) | gob |
| ENABLE_COMPRESSION | æ˜¯å¦å¯ç”¨å‹ç¼© | false |
| MIN_SIZE_TO_COMPRESS | æœ€å°å‹ç¼©é˜ˆå€¼(å­—èŠ‚) | 1024 |
| GC_PERCENT | GCè§¦å‘ç™¾åˆ†æ¯” | 100 |
| OPTIMIZE_MEMORY | æ˜¯å¦ä¼˜åŒ–å†…å­˜ | true |
| PLUGIN_TIMEOUT | æ’ä»¶æ‰§è¡Œè¶…æ—¶æ—¶é—´(ç§’) | 30 |
| ASYNC_PLUGIN_ENABLED | æ˜¯å¦å¯ç”¨å¼‚æ­¥æ’ä»¶ | true |
| ASYNC_RESPONSE_TIMEOUT | å¼‚æ­¥å“åº”è¶…æ—¶æ—¶é—´(ç§’) | 4 |
| ASYNC_MAX_BACKGROUND_WORKERS | æœ€å¤§åå°å·¥ä½œè€…æ•°é‡ | CPUæ ¸å¿ƒæ•°Ã—5ï¼Œæœ€å°20 |
| ASYNC_MAX_BACKGROUND_TASKS | æœ€å¤§åå°ä»»åŠ¡æ•°é‡ | å·¥ä½œè€…æ•°é‡Ã—5ï¼Œæœ€å°100 |
| ASYNC_CACHE_TTL_HOURS | å¼‚æ­¥ç¼“å­˜æœ‰æ•ˆæœŸ(å°æ—¶) | 1 |
| HTTP_READ_TIMEOUT | HTTPè¯»å–è¶…æ—¶æ—¶é—´(ç§’) | è‡ªåŠ¨è®¡ç®—ï¼Œæœ€å°30 |
| HTTP_WRITE_TIMEOUT | HTTPå†™å…¥è¶…æ—¶æ—¶é—´(ç§’) | è‡ªåŠ¨è®¡ç®—ï¼Œæœ€å°60 |
| HTTP_IDLE_TIMEOUT | HTTPç©ºé—²è¿æ¥è¶…æ—¶æ—¶é—´(ç§’) | 120 |
| HTTP_MAX_CONNS | HTTPæœ€å¤§å¹¶å‘è¿æ¥æ•° | CPUæ ¸å¿ƒæ•°Ã—25ï¼Œæœ€å°100ï¼Œæœ€å¤§500 |
| ASYNC_LOG_ENABLED | å¼‚æ­¥æ’ä»¶è¯¦ç»†æ—¥å¿—å¼€å…³ | true |

### ğŸ”§ æ€§èƒ½ä¼˜åŒ–é…ç½®

ä¸ºä¸åŒç¯å¢ƒæä¾›çš„ä¼˜åŒ–é…ç½®æ–¹æ¡ˆï¼š

#### macOS/ç¬”è®°æœ¬ç”µè„‘é…ç½® (æ¨è)
```bash
# é’ˆå¯¹macOSç³»ç»Ÿçº¿ç¨‹é™åˆ¶ä¼˜åŒ–çš„é…ç½®
export HTTP_MAX_CONNS=200                   # é™ä½è¿æ¥æ•°
export ASYNC_MAX_BACKGROUND_WORKERS=15     # å‡å°‘å·¥ä½œè€…æ•°é‡  
export ASYNC_MAX_BACKGROUND_TASKS=75       # å‡å°‘ä»»åŠ¡é˜Ÿåˆ—
export CONCURRENCY=30                      # é€‚ä¸­çš„å¹¶å‘æ•°
export ASYNC_LOG_ENABLED=false             # å…³é—­è¯¦ç»†æ—¥å¿—
```

#### æœåŠ¡å™¨/äº‘ç¯å¢ƒé…ç½®
```bash
# é«˜æ€§èƒ½æœåŠ¡å™¨é…ç½®
export HTTP_MAX_CONNS=500                   # æ›´é«˜çš„è¿æ¥æ•°
export ASYNC_MAX_BACKGROUND_WORKERS=40     # æ›´å¤šå·¥ä½œè€…
export ASYNC_MAX_BACKGROUND_TASKS=200      # æ›´å¤§ä»»åŠ¡é˜Ÿåˆ—
export CONCURRENCY=50                      # é«˜å¹¶å‘æ•°
export CACHE_MAX_SIZE=500                  # æ›´å¤§ç¼“å­˜
export ASYNC_LOG_ENABLED=false             # å…³é—­è¯¦ç»†æ—¥å¿—
```

#### èµ„æºå—é™ç¯å¢ƒé…ç½®
```bash
# ä½é…ç½®æœåŠ¡å™¨æˆ–å®¹å™¨ç¯å¢ƒ
export HTTP_MAX_CONNS=100                   # æœ€ä½è¿æ¥æ•°
export ASYNC_MAX_BACKGROUND_WORKERS=8      # æœ€å°‘å·¥ä½œè€…
export ASYNC_MAX_BACKGROUND_TASKS=40       # æœ€å°ä»»åŠ¡é˜Ÿåˆ—
export CONCURRENCY=15                      # ä½å¹¶å‘æ•°
export CACHE_MAX_SIZE=50                   # è¾ƒå°ç¼“å­˜
```


3. æ„å»º

```linux
CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags="-s -w -extldflags '-static'" -o pansou .
```

4. è¿è¡Œ

```bash
./pansou
```

### å…¶ä»–é…ç½®å‚è€ƒ

`supervisor`é…ç½®å‚è€ƒ

```
[program:pansou]
environment=PORT=8888,CHANNELS="SharePanBaidu,yunpanxunlei,tianyifc,BaiduCloudDisk,txtyzy,peccxinpd,gotopan,xingqiump4,yunpanqk,PanjClub,kkxlzy,baicaoZY,MCPH01,share_aliyun,pan115_share,bdwpzhpd,ysxb48,pankuake_share,jdjdn1111,yggpan,yunpanall,MCPH086,zaihuayun,Q66Share,NewAliPan,Oscar_4Kmovies,ucwpzy,alyp_TV,alyp_4K_Movies,shareAliyun,alyp_1,yunpanpan,hao115,yunpanshare,dianyingshare,Quark_Movies,XiangxiuNBB,NewQuark,ydypzyfx,kuakeyun,ucquark,xx123pan,yingshifenxiang123,zyfb123,pan123pan,tyypzhpd,tianyirigeng,cloudtianyi,hdhhd21,Lsp115,oneonefivewpfx,Maidanglaocom,qixingzhenren,taoxgzy,tgsearchers115,Channel_Shares_115,tyysypzypd,vip115hot,wp123zy,yunpan139,yunpan189,yunpanuc,yydf_hzl,alyp_Animation,alyp_JLP,tgsearchers2,leoziyuan"
command=/home/work/pansou/pansou
directory=/home/work/pansou
autostart=true
autorestart=true
startsecs=5
startretries=3
exitcodes=0
stopwaitsecs=10
stopasgroup=true
killasgroup=true
```

`nginx`é…ç½®å‚è€ƒ

```
server {
    listen 80;
    server_name pansou.252035.xyz;

    # å°† HTTP é‡å®šå‘åˆ° HTTPS
    return 301 https://$host$request_uri;
}

limit_req_zone $binary_remote_addr zone=api_limit:10m rate=60r/m;

server {
    listen 443 ssl http2;
    server_name pansou.252035.xyz;

    access_log /home/work/logs/pansou.log;

    # è¯ä¹¦å’Œå¯†é’¥è·¯å¾„
    ssl_certificate /etc/letsencrypt/live/252035.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/252035.xyz/privkey.pem;

    # å¢å¼º SSL å®‰å…¨æ€§
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH;
    ssl_prefer_server_ciphers on;

    # åç«¯ä»£ç†ï¼Œåº”ç”¨é™æµ
    location / {
        # åº”ç”¨é™æµè§„åˆ™
        limit_req zone=api_limit burst=10 nodelay;
        # å½“è¶…è¿‡é™åˆ¶æ—¶è¿”å› 429 çŠ¶æ€ç 
        limit_req_status 429;

        proxy_pass http://127.0.0.1:8888;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

## APIæ–‡æ¡£

### æœç´¢API

æœç´¢ç½‘ç›˜èµ„æºã€‚

**æ¥å£åœ°å€**ï¼š`/api/search`  
**è¯·æ±‚æ–¹æ³•**ï¼š`POST` æˆ– `GET`  
**Content-Type**ï¼š`application/json`ï¼ˆPOSTæ–¹æ³•ï¼‰

**POSTè¯·æ±‚å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| kw | string | æ˜¯ | æœç´¢å…³é”®è¯ |
| channels | string[] | å¦ | æœç´¢çš„é¢‘é“åˆ—è¡¨ï¼Œä¸æä¾›åˆ™ä½¿ç”¨é»˜è®¤é…ç½® |
| conc | number | å¦ | å¹¶å‘æœç´¢æ•°é‡ï¼Œä¸æä¾›åˆ™è‡ªåŠ¨è®¾ç½®ä¸ºé¢‘é“æ•°+æ’ä»¶æ•°+10 |
| refresh | boolean | å¦ | å¼ºåˆ¶åˆ·æ–°ï¼Œä¸ä½¿ç”¨ç¼“å­˜ï¼Œä¾¿äºè°ƒè¯•å’Œè·å–æœ€æ–°æ•°æ® |
| res | string | å¦ | ç»“æœç±»å‹ï¼šall(è¿”å›æ‰€æœ‰ç»“æœ)ã€results(ä»…è¿”å›results)ã€merge(ä»…è¿”å›merged_by_type)ï¼Œé»˜è®¤ä¸ºmerge |
| src | string | å¦ | æ•°æ®æ¥æºç±»å‹ï¼šall(é»˜è®¤ï¼Œå…¨éƒ¨æ¥æº)ã€tg(ä»…Telegram)ã€plugin(ä»…æ’ä»¶) |
| plugins | string[] | å¦ | æŒ‡å®šæœç´¢çš„æ’ä»¶åˆ—è¡¨ï¼Œä¸æŒ‡å®šåˆ™æœç´¢å…¨éƒ¨æ’ä»¶ |
| cloud_types | string[] | å¦ | æŒ‡å®šè¿”å›çš„ç½‘ç›˜ç±»å‹åˆ—è¡¨ï¼Œæ”¯æŒï¼šbaiduã€aliyunã€quarkã€tianyiã€ucã€mobileã€115ã€pikpakã€xunleiã€123ã€magnetã€ed2kï¼Œä¸æŒ‡å®šåˆ™è¿”å›æ‰€æœ‰ç±»å‹ |
| ext | object | å¦ | æ‰©å±•å‚æ•°ï¼Œç”¨äºä¼ é€’ç»™æ’ä»¶çš„è‡ªå®šä¹‰å‚æ•°ï¼Œå¦‚{"title_en":"English Title", "is_all":true} |

**GETè¯·æ±‚å‚æ•°**ï¼š

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|--------|------|------|------|
| kw | string | æ˜¯ | æœç´¢å…³é”®è¯ |
| channels | string | å¦ | æœç´¢çš„é¢‘é“åˆ—è¡¨ï¼Œä½¿ç”¨è‹±æ–‡é€—å·åˆ†éš”å¤šä¸ªé¢‘é“ï¼Œä¸æä¾›åˆ™ä½¿ç”¨é»˜è®¤é…ç½® |
| conc | number | å¦ | å¹¶å‘æœç´¢æ•°é‡ï¼Œä¸æä¾›åˆ™è‡ªåŠ¨è®¾ç½®ä¸ºé¢‘é“æ•°+æ’ä»¶æ•°+10 |
| refresh | boolean | å¦ | å¼ºåˆ¶åˆ·æ–°ï¼Œè®¾ç½®ä¸º"true"è¡¨ç¤ºä¸ä½¿ç”¨ç¼“å­˜ |
| res | string | å¦ | ç»“æœç±»å‹ï¼šall(è¿”å›æ‰€æœ‰ç»“æœ)ã€results(ä»…è¿”å›results)ã€merge(ä»…è¿”å›merged_by_type)ï¼Œé»˜è®¤ä¸ºmerge |
| src | string | å¦ | æ•°æ®æ¥æºç±»å‹ï¼šall(é»˜è®¤ï¼Œå…¨éƒ¨æ¥æº)ã€tg(ä»…Telegram)ã€plugin(ä»…æ’ä»¶) |
| plugins | string | å¦ | æŒ‡å®šæœç´¢çš„æ’ä»¶åˆ—è¡¨ï¼Œä½¿ç”¨è‹±æ–‡é€—å·åˆ†éš”å¤šä¸ªæ’ä»¶åï¼Œä¸æŒ‡å®šåˆ™æœç´¢å…¨éƒ¨æ’ä»¶ |
| cloud_types | string | å¦ | æŒ‡å®šè¿”å›çš„ç½‘ç›˜ç±»å‹åˆ—è¡¨ï¼Œä½¿ç”¨è‹±æ–‡é€—å·åˆ†éš”å¤šä¸ªç±»å‹ï¼Œæ”¯æŒï¼šbaiduã€aliyunã€quarkã€tianyiã€ucã€mobileã€115ã€pikpakã€xunleiã€123ã€magnetã€ed2kï¼Œä¸æŒ‡å®šåˆ™è¿”å›æ‰€æœ‰ç±»å‹ |
| ext | string | å¦ | JSONæ ¼å¼çš„æ‰©å±•å‚æ•°ï¼Œç”¨äºä¼ é€’ç»™æ’ä»¶çš„è‡ªå®šä¹‰å‚æ•°ï¼Œå¦‚{"title_en":"English Title", "is_all":true} |

**POSTè¯·æ±‚ç¤ºä¾‹**ï¼š

```json
{
  "kw": "é€Ÿåº¦ä¸æ¿€æƒ…",
  "channels": ["tgsearchers2", "xxx"],
  "conc": 2,
  "refresh": true,
  "res": "merge",
  "src": "all",
  "plugins": ["jikepan"],
  "cloud_types": ["baidu", "quark"],
  "ext": {
    "title_en": "Fast and Furious",
    "is_all": true
  }
}
```

**GETè¯·æ±‚ç¤ºä¾‹**ï¼š

```
GET /api/search?kw=é€Ÿåº¦ä¸æ¿€æƒ…&channels=tgsearchers2,xxx&conc=2&refresh=true&res=merge&src=tg&cloud_types=baidu,quark&ext={"title_en":"Fast and Furious","is_all":true}
```

**æˆåŠŸå“åº”**ï¼š

```json
{
  "total": 15,
  "results": [
    {
      "message_id": "12345",
      "unique_id": "channel-12345",
      "channel": "tgsearchers2",
      "datetime": "2023-06-10T14:23:45Z",
      "title": "é€Ÿåº¦ä¸æ¿€æƒ…å…¨é›†1-10",
      "content": "é€Ÿåº¦ä¸æ¿€æƒ…ç³»åˆ—å…¨é›†ï¼Œ1080Pé«˜æ¸…...",
      "links": [
        {
          "type": "baidu",
          "url": "https://pan.baidu.com/s/1abcdef",
          "password": "1234"
        }
      ],
      "tags": ["ç”µå½±", "åˆé›†"]
    },
    // æ›´å¤šç»“æœ...
  ],
  "merged_by_type": {
    "baidu": [
      {
        "url": "https://pan.baidu.com/s/1abcdef",
        "password": "1234",
        "note": "é€Ÿåº¦ä¸æ¿€æƒ…å…¨é›†1-10",
        "datetime": "2023-06-10T14:23:45Z",
        "source": "tg:é¢‘é“åç§°"
      },
      // æ›´å¤šç™¾åº¦ç½‘ç›˜é“¾æ¥...
    ],
    "quark": [
      {
        "url": "https://pan.quark.cn/s/xxxx",
        "password": "",
        "note": "å‡¡äººä¿®ä»™ä¼ ",
        "datetime": "2023-06-10T15:30:22Z",
        "source": "plugin:æ’ä»¶å"
      }
    ],
    "aliyun": [
      // é˜¿é‡Œäº‘ç›˜é“¾æ¥...
    ]
    // æ›´å¤šç½‘ç›˜ç±»å‹...
  }
}
```

**å­—æ®µè¯´æ˜**ï¼š

- `source`: æ•°æ®æ¥æºæ ‡è¯†
  - `tg:é¢‘é“åç§°`: æ¥è‡ªTelegramé¢‘é“
  - `plugin:æ’ä»¶å`: æ¥è‡ªæŒ‡å®šæ’ä»¶
  - `unknown`: æœªçŸ¥æ¥æº

**é”™è¯¯å“åº”**ï¼š

```json
{
  "code": 400,
  "message": "å…³é”®è¯ä¸èƒ½ä¸ºç©º"
}
```

### å¥åº·æ£€æŸ¥

æ£€æŸ¥APIæœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚

**æ¥å£åœ°å€**ï¼š`/api/health`  
**è¯·æ±‚æ–¹æ³•**ï¼š`GET`

**æˆåŠŸå“åº”**ï¼š

```json
{
  "channels": [
    "tgsearchers2"
  ],
  "plugin_count": 16,
  "plugins": [
    "pansearch",
    "panta", 
    "qupansou",
    "hunhepan",
    "jikepan",
    "pan666",
    "panyq",
    "susu",
    "xuexizhinan",
    "hdr4k",
    "labi",
    "shandian",
    "duoduo",
    "muou",
    "wanou",
    "ouge",
    "zhizhen",
    "huban"
  ],
  "plugins_enabled": true,
  "status": "ok"
}
```

## â­ Star å†å²

[![Star History Chart](https://api.star-history.com/svg?repos=fish2018/pansou&type=Date)](https://star-history.com/#fish2018/pansou&Date)